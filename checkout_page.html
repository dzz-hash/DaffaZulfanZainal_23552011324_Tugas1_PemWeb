<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Checkout - Deehide</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Project CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- Theme & Animation -->
  <script src="theme-toggle.js" defer></script>
  <script src="animation.js" defer></script>

  <style>
    .product-thumb { width:72px; height:72px; object-fit:cover; border-radius:8px; }
    .summary-box { background:var(--card-dark); border-radius:12px; padding:20px; border:1px solid rgba(255,255,255,.04); }
    .small-muted { font-size:.9rem; color:rgba(255,255,255,.65); }
    .note { font-size:.9rem; color:rgba(255,255,255,.7); }
  </style>
</head>
<body class="dark-mode">


<!-- ================================================================= -->
<!--                           NAVBAR SIMPLE                           -->
<!-- ================================================================= -->
<nav class="navbar navbar-expand-lg navbar-dark px-4" style="border-bottom:2px solid var(--accent);">
  <a class="navbar-brand d-flex align-items-center" href="home_page.html">
    <img src="images/logo2.png" class="me-2" style="height:44px;">
    <span class="brand-title">DEEHIDE</span>
  </a>

  <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navMain">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navMain">
    <ul class="navbar-nav ms-auto align-items-center">

      <!-- Always Allowed -->
      <li class="nav-item">
        <a class="nav-link ignore-protect" href="home_page.html">Home</a>
      </li>

      <!-- Protected -->
      <li class="nav-item">
        <a class="nav-link nav-protect" data-link="shop_page.html">Shop</a>
      </li>

      <li class="nav-item ms-3">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="themeToggle">
        </div>
      </li>

    </ul>
  </div>
</nav>


<script>
document.addEventListener("DOMContentLoaded", () => {
  const user = localStorage.getItem("vt-current");

  const protect = document.querySelectorAll(".nav-protect");
  protect.forEach(btn => {
    btn.addEventListener("click", e => {
      e.preventDefault();
      if (!user) {
        Swal.fire({
          icon: "warning",
          title: "Login Required",
          text: "Silakan login terlebih dahulu!",
          confirmButtonColor: "#ff0033",
        }).then(() => window.location.href = "login.html");
      } else {
        window.location.href = btn.dataset.link;
      }
    });
  });
});
</script>


<!-- MARQUEE -->
<div class="marquee">
  <span>⚡ CHECKOUT • DEEHIDE • COMPLETE YOUR ORDER ⚡</span>
</div>



<!-- ================================================================= -->
<!--                           PAGE CONTENT                            -->
<!-- ================================================================= -->
<div class="container py-5">
  <div class="row g-4">

    <!-- LEFT SIDE -->
    <div class="col-lg-8">

      <!-- CART REVIEW -->
      <div class="card mb-4" style="background:var(--card-dark);">
        <div class="card-body">
          <h5 class="card-title mb-3">Review Pesanan</h5>
          <div id="cartList" class="list-group list-group-flush"></div>
          <p id="emptyNote" class="small-muted mt-3" style="display:none;">Keranjang kosong.</p>
        </div>
      </div>

      <!-- SHIPPING FORM -->
      <div class="card mb-4" style="background:var(--card-dark);">
        <div class="card-body">
          <h5 class="card-title mb-3">Alamat Pengiriman</h5>

          <form id="shippingForm">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Nama Penerima</label>
                <input required id="shipName" class="form-control" placeholder="Nama lengkap">
              </div>

              <div class="col-md-6">
                <label class="form-label">Nomor Telepon</label>
                <input required id="shipPhone" class="form-control" placeholder="08xxxx">
              </div>

              <div class="col-12">
                <label class="form-label">Alamat Lengkap</label>
                <input required id="shipAddress" class="form-control" placeholder="Jalan, RT/RW, Kelurahan">
              </div>

              <div class="col-md-4">
                <label class="form-label">Kota</label>
                <input required id="shipCity" class="form-control">
              </div>

              <div class="col-md-4">
                <label class="form-label">Provinsi</label>
                <input required id="shipProv" class="form-control">
              </div>

              <div class="col-md-4">
                <label class="form-label">Kode Pos</label>
                <input required id="shipPost" class="form-control">
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- PAYMENT -->
      <div class="card mb-4" style="background:var(--card-dark);">
        <div class="card-body">
          <h5 class="card-title mb-3">Metode Pembayaran</h5>

          <div class="form-check">
            <input class="form-check-input" type="radio" name="payMethod" value="bank" checked>
            <label class="form-check-label">Transfer Bank (Manual)</label>
          </div>

          <div class="form-check mt-2">
            <input class="form-check-input" type="radio" name="payMethod" value="cod">
            <label class="form-check-label">Bayar di Tempat (COD)</label>
          </div>

        </div>
      </div>

    </div>



    <!-- RIGHT SIDE SUMMARY -->
    <div class="col-lg-4">
      <div class="summary-box">
        <h5 class="mb-3">Ringkasan</h5>

        <div class="d-flex justify-content-between small-muted">
          <span>Subtotal</span><span id="subTotalText">Rp 0</span>
        </div>
        <div class="d-flex justify-content-between small-muted mt-2">
          <span>Ongkir</span><span id="shipFeeText">Rp 0</span>
        </div>

        <hr>

        <div class="d-flex justify-content-between">
          <span>Total</span><strong id="totalText">Rp 0</strong>
        </div>

        <button id="btnCheckout" class="btn btn-danger w-100 mt-3 fw-bold">Proses Pembayaran</button>
      </div>
    </div>

  </div>
</div>



<!-- MARQUEE -->
<div class="marquee"><span>⚡ DEEHIDE • YOUR FASHION IS YOUR IDENTITY ⚡</span></div>



<!-- FOOTER -->
<footer class="site-footer text-center py-4">
  <img src="images/logo2.png" height="70" class="mb-3">
  <p class="footer-copy">23552011324_DAFFA ZULFAN ZAINAL_TIF RP 23 CNS B</p>
</footer>



<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


<!-- ================================================================= -->
<!--                          PAGE SCRIPT                               -->
<!-- ================================================================= -->
<script>

function formatRp(n){ return "Rp " + Number(n).toLocaleString("id-ID"); }

function loadCart(){
  const cart = JSON.parse(localStorage.getItem("vt-cart") || "[]");
  const list = document.getElementById("cartList");
  const empty = document.getElementById("emptyNote");

  let subtotal = 0;
  list.innerHTML = "";

  if(cart.length === 0){
    empty.style.display = "block";
  } else {
    empty.style.display = "none";
  }

  cart.forEach((item, i) => {
    const price = item.price * item.qty;
    subtotal += price;

    const row = document.createElement("div");
    row.className = "list-group-item bg-transparent d-flex justify-content-between align-items-center";

    row.innerHTML = `
      <div class="d-flex align-items-center gap-3">
        <img src="${item.img}" class="product-thumb">
        <div>
          <strong>${item.title}</strong><br>
          <span class="small-muted">Size: ${item.size}</span><br>
          <span class="small-muted">${formatRp(item.price)}</span>
        </div>
      </div>

      <div class="text-end">
        <strong>${formatRp(price)}</strong>
      </div>
    `;

    list.appendChild(row);
  });

  const ship = subtotal >= 500000 ? 0 : (subtotal === 0 ? 0 : 20000);

  document.getElementById("subTotalText").innerText = formatRp(subtotal);
  document.getElementById("shipFeeText").innerText = formatRp(ship);
  document.getElementById("totalText").innerText = formatRp(subtotal + ship);
}

document.getElementById("btnCheckout").onclick = () => {
  const user = localStorage.getItem("vt-current");
  if(!user){
    return Swal.fire({
      icon:"warning",
      title:"Login Required",
      text:"Silakan login terlebih dahulu!",
      confirmButtonColor:"#ff0033"
    }).then(()=> window.location.href="login.html");
  }

  Swal.fire({
    icon:"success",
    title:"Pesanan Dibuat",
    text:"Pesananmu sedang diproses.",
    confirmButtonColor:"#ff0033"
  }).then(() => {
    localStorage.removeItem("vt-cart");
    window.location.href = "dashboard_page.html";
  });
};

document.addEventListener("DOMContentLoaded", loadCart);
</script>

</body>
</html>
